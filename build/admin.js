(()=>{"use strict";var e,r={272(e,r,t){const n=window.React,a=window.wp.element,s=window.wp.components,l=window.wp.i18n,c=window.wp.apiFetch;var o=t.n(c);const i=({settings:e,updateSetting:r})=>(0,n.createElement)(s.Card,{className:"nhrrob-secure-card"},(0,n.createElement)(s.CardBody,null,(0,n.createElement)("h2",{className:"nhrrob-secure-card-title"},(0,l.__)("Login Protection","nhrrob-secure")),(0,n.createElement)(s.ToggleControl,{label:(0,l.__)("Enable Login Attempts Limit","nhrrob-secure"),help:(0,l.__)("Limit failed login attempts to prevent brute force attacks","nhrrob-secure"),checked:e.nhrrob_secure_limit_login_attempts,onChange:e=>r("nhrrob_secure_limit_login_attempts",e)}),e.nhrrob_secure_limit_login_attempts&&(0,n.createElement)(s.TextControl,{label:(0,l.__)("Maximum Login Attempts","nhrrob-secure"),help:(0,l.__)("Number of failed attempts before blocking (default: 5)","nhrrob-secure"),type:"number",value:e.nhrrob_secure_login_attempts_limit,onChange:e=>r("nhrrob_secure_login_attempts_limit",parseInt(e)||5),min:"1",max:"20"}),(0,n.createElement)(s.ToggleControl,{label:(0,l.__)("Enable Proxy IP Detection","nhrrob-secure"),help:(0,l.__)("Detect real IP behind proxies (Cloudflare, etc.)","nhrrob-secure"),checked:e.nhrrob_secure_enable_proxy_ip,onChange:e=>r("nhrrob_secure_enable_proxy_ip",e)}))),u=({settings:e,updateSetting:r})=>(0,n.createElement)(s.Card,{className:"nhrrob-secure-card"},(0,n.createElement)(s.CardBody,null,(0,n.createElement)("h2",{className:"nhrrob-secure-card-title"},(0,l.__)("Custom Login Page","nhrrob-secure")),(0,n.createElement)(s.ToggleControl,{label:(0,l.__)("Enable Custom Login URL","nhrrob-secure"),help:(0,l.__)("Hide wp-login.php and use a custom login URL","nhrrob-secure"),checked:e.nhrrob_secure_custom_login_page,onChange:e=>r("nhrrob_secure_custom_login_page",e)}),e.nhrrob_secure_custom_login_page&&(0,n.createElement)(s.TextControl,{label:(0,l.__)("Custom Login URL","nhrrob-secure"),help:(0,l.__)("Your login page will be accessible at this URL","nhrrob-secure"),value:e.nhrrob_secure_custom_login_url,onChange:e=>r("nhrrob_secure_custom_login_url",e),placeholder:"/hidden-access-52w"}),e.nhrrob_secure_custom_login_page&&(0,n.createElement)("div",{className:"nhrrob-secure-info"},(0,n.createElement)("strong",null,(0,l.__)("Your login URL:","nhrrob-secure")),(0,n.createElement)("code",null,window.location.origin,e.nhrrob_secure_custom_login_url)))),m=({settings:e,updateSetting:r})=>{const t=e.nhrrob_secure_2fa_enforced_roles||[],a=e.available_roles||[];return(0,n.createElement)(s.Card,{className:"nhrrob-secure-card"},(0,n.createElement)(s.CardBody,null,(0,n.createElement)("h2",{className:"nhrrob-secure-card-title"},(0,l.__)("Two-Factor Authentication","nhrrob-secure")),(0,n.createElement)(s.ToggleControl,{label:(0,l.__)("Enable Global 2FA","nhrrob-secure"),help:(0,n.createElement)(n.Fragment,null,(0,l.__)("Enables Google Authenticator support for all users. Users can set it up in their ","nhrrob-secure"),(0,n.createElement)("a",{href:nhrrobSecureSettings.profile_url,target:"_blank",rel:"noreferrer"},(0,l.__)("profile page","nhrrob-secure")),"."),checked:e.nhrrob_secure_enable_2fa,onChange:e=>r("nhrrob_secure_enable_2fa",e)}),e.nhrrob_secure_enable_2fa&&(0,n.createElement)(n.Fragment,null,(0,n.createElement)("div",{className:"nhrrob-secure-2fa-method pt-4 border-t border-gray-100"},(0,n.createElement)("h3",{className:"text-sm font-semibold mb-3"},(0,l.__)("2FA Method","nhrrob-secure")),(0,n.createElement)(s.RadioControl,{selected:e.nhrrob_secure_2fa_type||"app",options:[{label:(0,l.__)("Authenticator App (Recommended)","nhrrob-secure"),value:"app"},{label:(0,l.__)("Email OTP","nhrrob-secure"),value:"email"}],onChange:e=>r("nhrrob_secure_2fa_type",e)})),(0,n.createElement)("div",{className:"nhrrob-secure-enforced-roles pt-4 border-t border-gray-100"},(0,n.createElement)("h3",{className:"text-sm font-semibold mb-3"},(0,l.__)("Enforced 2FA by Role","nhrrob-secure")),(0,n.createElement)("p",{className:"text-xs text-gray-500 mb-4"},(0,l.__)("Users with the selected roles will be forced to set up 2FA before they can access the admin dashboard.","nhrrob-secure")),(0,n.createElement)("div",{className:"grid grid-cols-2 gap-2"},a.map(e=>(0,n.createElement)(s.CheckboxControl,{key:e.value,label:e.label,checked:t.includes(e.value),onChange:n=>((e,n)=>{const a=n?[...t,e]:t.filter(r=>r!==e);r("nhrrob_secure_2fa_enforced_roles",a)})(e.value,n)})))))))},h=({settings:e,updateSetting:r})=>(0,n.createElement)(s.Card,{className:"nhrrob-secure-card"},(0,n.createElement)(s.CardBody,null,(0,n.createElement)("h2",{className:"nhrrob-secure-card-title"},(0,l.__)("File Protection","nhrrob-secure")),(0,n.createElement)(s.ToggleControl,{label:(0,l.__)("Protect Debug Log","nhrrob-secure"),help:(0,l.__)("Block direct access to wp-content/debug.log","nhrrob-secure"),checked:e.nhrrob_secure_protect_debug_log,onChange:e=>r("nhrrob_secure_protect_debug_log",e)}))),_=()=>{const[e,r]=(0,a.useState)(null),[t,c]=(0,a.useState)(!0),[i,u]=(0,a.useState)(!1),[m,h]=(0,a.useState)(null);(0,a.useEffect)(()=>{_()},[]);const _=async()=>{try{const e=await o()({path:"/nhrrob-secure/v1/vulnerability/status"});r(e),c(!1)}catch(e){h((0,l.__)("Failed to fetch vulnerability status","nhrrob-secure")),c(!1)}};if(t)return(0,n.createElement)(s.Card,{className:"nhrrob-secure-card"},(0,n.createElement)(s.CardBody,null,(0,n.createElement)(s.Spinner,null)));const b=e&&(e.core.length>0||e.plugins.length>0||e.themes.length>0);return(0,n.createElement)(s.Card,{className:"nhrrob-secure-card nhrrob-secure-vulnerability-card"},(0,n.createElement)(s.CardBody,null,(0,n.createElement)("div",{className:"nhrrob-secure-card-header-flex"},(0,n.createElement)("h2",{className:"nhrrob-secure-card-title"},(0,l.__)("Vulnerability Checker","nhrrob-secure")),(0,n.createElement)(s.Button,{variant:"secondary",isSmall:!0,onClick:async()=>{u(!0),h(null);try{const e=await o()({path:"/nhrrob-secure/v1/vulnerability/scan",method:"POST"});r(e)}catch(e){h((0,l.__)("Failed to run vulnerability scan","nhrrob-secure"))}finally{u(!1)}},isBusy:i,disabled:i},i?(0,l.__)("Scanning...","nhrrob-secure"):(0,l.__)("Scan Now","nhrrob-secure"))),(0,n.createElement)("p",{className:"nhrrob-secure-last-scan"},(0,n.createElement)("strong",null,(0,l.__)("Last Scan:","nhrrob-secure"))," ",(d=e.last_scan)?new Date(1e3*d).toLocaleString():(0,l.__)("Never","nhrrob-secure")),m&&(0,n.createElement)(s.Notice,{status:"error",isDismissible:!1},m),b?(0,n.createElement)("div",{className:"nhrrob-secure-vulnerability-list"},(0,n.createElement)(s.Notice,{status:"warning",isDismissible:!1},(0,l.__)("Vulnerabilities detected! Please review and update the items below.","nhrrob-secure")),e.core.length>0&&(0,n.createElement)("div",{className:"vulnerability-section"},(0,n.createElement)("h3",null,(0,l.__)("WordPress Core","nhrrob-secure")),(0,n.createElement)("ul",null,e.core.map((e,r)=>(0,n.createElement)("li",{key:r},e.name)))),e.plugins.length>0&&(0,n.createElement)("div",{className:"vulnerability-section"},(0,n.createElement)("h3",null,(0,l.__)("Plugins","nhrrob-secure")),e.plugins.map((e,r)=>(0,n.createElement)("div",{key:r,className:"vulnerability-item"},(0,n.createElement)("strong",null,e.name," (",e.version,")"),(0,n.createElement)("ul",null,e.vulnerabilities.map((e,r)=>(0,n.createElement)("li",{key:r},e.name)))))),e.themes.length>0&&(0,n.createElement)("div",{className:"vulnerability-section"},(0,n.createElement)("h3",null,(0,l.__)("Themes","nhrrob-secure")),e.themes.map((e,r)=>(0,n.createElement)("div",{key:r,className:"vulnerability-item"},(0,n.createElement)("strong",null,e.name," (",e.version,")"),(0,n.createElement)("ul",null,e.vulnerabilities.map((e,r)=>(0,n.createElement)("li",{key:r},e.name))))))):(0,n.createElement)("div",{className:"nhrrob-secure-status-success"},(0,n.createElement)("span",{className:"dashicons dashicons-yes-alt"}),(0,l.__)("No vulnerabilities detected. Your site is secure.","nhrrob-secure"))));var d},b=document.getElementById("nhrrob-secure-settings-root");b&&(0,a.render)((0,n.createElement)(()=>{const[e,r]=(0,a.useState)(null),[t,c]=(0,a.useState)(!0),[b,d]=(0,a.useState)(!1),[g,p]=(0,a.useState)(null);(0,a.useEffect)(()=>{E()},[]);const E=async()=>{try{const e=await o()({path:"/nhrrob-secure/v1/settings"});r(e),c(!1)}catch(e){p({type:"error",message:(0,l.__)("Failed to load settings","nhrrob-secure")}),c(!1)}},v=(t,n)=>{r({...e,[t]:n})};return(0,a.useEffect)(()=>{e?.nhrrob_secure_dark_mode?document.body.classList.add("nhrrob-secure-dark-mode-active"):document.body.classList.remove("nhrrob-secure-dark-mode-active")},[e?.nhrrob_secure_dark_mode]),t?(0,n.createElement)("div",{className:"nhrrob-secure-loading"},(0,n.createElement)(s.Spinner,null)):(0,n.createElement)("div",{className:"nhrrob-secure-settings "+(e.nhrrob_secure_dark_mode?"dark-mode":"")},(0,n.createElement)("div",{className:"nhrrob-secure-header"},(0,n.createElement)("div",{className:"nhrrob-secure-header-main"},(0,n.createElement)("h1",null,(0,l.__)("NHR Secure Settings","nhrrob-secure")),(0,n.createElement)(s.Button,{className:"nhrrob-secure-dark-mode-toggle",icon:e.nhrrob_secure_dark_mode?(0,n.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20"},(0,n.createElement)("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 00-1.41-1.41l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 00-1.41-1.41l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})):(0,n.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20"},(0,n.createElement)("path",{d:"M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"})),onClick:async()=>{const r=!e.nhrrob_secure_dark_mode;v("nhrrob_secure_dark_mode",r);try{await o()({path:"/nhrrob-secure/v1/settings",method:"POST",data:{...e,nhrrob_secure_dark_mode:r}})}catch(e){console.error("Failed to save dark mode preference",e)}},label:(0,l.__)("Toggle Dark Mode","nhrrob-secure")})),(0,n.createElement)("p",{className:"nhrrob-secure-subtitle"},(0,l.__)("Configure security features for your WordPress site","nhrrob-secure"))),g&&(0,n.createElement)(s.Notice,{status:g.type,isDismissible:!0,onRemove:()=>p(null)},g.message),(0,n.createElement)("div",{className:"nhrrob-secure-cards"},(0,n.createElement)(i,{settings:e,updateSetting:v}),(0,n.createElement)(u,{settings:e,updateSetting:v}),(0,n.createElement)(m,{settings:e,updateSetting:v}),(0,n.createElement)(h,{settings:e,updateSetting:v}),(0,n.createElement)(_,null)),(0,n.createElement)("div",{className:"nhrrob-secure-actions"},(0,n.createElement)(s.Button,{variant:"primary",onClick:async()=>{d(!0),p(null);try{await o()({path:"/nhrrob-secure/v1/settings",method:"POST",data:e}),p({type:"success",message:(0,l.__)("Settings saved successfully!","nhrrob-secure")})}catch(e){p({type:"error",message:(0,l.__)("Failed to save settings","nhrrob-secure")})}finally{d(!1)}},isBusy:b,disabled:b},b?(0,l.__)("Saving...","nhrrob-secure"):(0,l.__)("Save Settings","nhrrob-secure"))))},null),b)}},t={};function n(e){var a=t[e];if(void 0!==a)return a.exports;var s=t[e]={exports:{}};return r[e](s,s.exports,n),s.exports}n.m=r,e=[],n.O=(r,t,a,s)=>{if(!t){var l=1/0;for(u=0;u<e.length;u++){for(var[t,a,s]=e[u],c=!0,o=0;o<t.length;o++)(!1&s||l>=s)&&Object.keys(n.O).every(e=>n.O[e](t[o]))?t.splice(o--,1):(c=!1,s<l&&(l=s));if(c){e.splice(u--,1);var i=a();void 0!==i&&(r=i)}}return r}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[t,a,s]},n.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return n.d(r,{a:r}),r},n.d=(e,r)=>{for(var t in r)n.o(r,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},n.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),(()=>{var e={884:0,15:0};n.O.j=r=>0===e[r];var r=(r,t)=>{var a,s,[l,c,o]=t,i=0;if(l.some(r=>0!==e[r])){for(a in c)n.o(c,a)&&(n.m[a]=c[a]);if(o)var u=o(n)}for(r&&r(t);i<l.length;i++)s=l[i],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(u)},t=globalThis.webpackChunknhrrob_secure=globalThis.webpackChunknhrrob_secure||[];t.forEach(r.bind(null,0)),t.push=r.bind(null,t.push.bind(t))})();var a=n.O(void 0,[15],()=>n(272));a=n.O(a)})();