(()=>{"use strict";var e,r={855(e,r,t){const a=window.React,l=window.wp.element,n=window.wp.components,s=window.wp.i18n,c=window.wp.apiFetch;var o=t.n(c);const i=({settings:e,updateSetting:r})=>(0,a.createElement)(n.Card,{className:"nhrrob-secure-card"},(0,a.createElement)(n.CardBody,null,(0,a.createElement)("h2",{className:"nhrrob-secure-card-title"},(0,s.__)("Login Protection","nhrrob-secure")),(0,a.createElement)(n.ToggleControl,{label:(0,s.__)("Enable Login Attempts Limit","nhrrob-secure"),help:(0,s.__)("Limit failed login attempts to prevent brute force attacks","nhrrob-secure"),checked:e.nhrrob_secure_limit_login_attempts,onChange:e=>r("nhrrob_secure_limit_login_attempts",e)}),e.nhrrob_secure_limit_login_attempts&&(0,a.createElement)(n.TextControl,{label:(0,s.__)("Maximum Login Attempts","nhrrob-secure"),help:(0,s.__)("Number of failed attempts before blocking (default: 5)","nhrrob-secure"),type:"number",value:e.nhrrob_secure_login_attempts_limit,onChange:e=>r("nhrrob_secure_login_attempts_limit",parseInt(e)||5),min:"1",max:"20"}),(0,a.createElement)(n.ToggleControl,{label:(0,s.__)("Enable Proxy IP Detection","nhrrob-secure"),help:(0,s.__)("Detect real IP behind proxies (Cloudflare, etc.)","nhrrob-secure"),checked:e.nhrrob_secure_enable_proxy_ip,onChange:e=>r("nhrrob_secure_enable_proxy_ip",e)}))),u=({settings:e,updateSetting:r})=>(0,a.createElement)(n.Card,{className:"nhrrob-secure-card"},(0,a.createElement)(n.CardBody,null,(0,a.createElement)("h2",{className:"nhrrob-secure-card-title"},(0,s.__)("Custom Login Page","nhrrob-secure")),(0,a.createElement)(n.ToggleControl,{label:(0,s.__)("Enable Custom Login URL","nhrrob-secure"),help:(0,s.__)("Hide wp-login.php and use a custom login URL","nhrrob-secure"),checked:e.nhrrob_secure_custom_login_page,onChange:e=>r("nhrrob_secure_custom_login_page",e)}),e.nhrrob_secure_custom_login_page&&(0,a.createElement)(n.TextControl,{label:(0,s.__)("Custom Login URL","nhrrob-secure"),help:(0,s.__)("Your login page will be accessible at this URL","nhrrob-secure"),value:e.nhrrob_secure_custom_login_url,onChange:e=>r("nhrrob_secure_custom_login_url",e),placeholder:"/hidden-access-52w"}),e.nhrrob_secure_custom_login_page&&(0,a.createElement)("div",{className:"nhrrob-secure-info"},(0,a.createElement)("strong",null,(0,s.__)("Your login URL:","nhrrob-secure")),(0,a.createElement)("code",null,window.location.origin,e.nhrrob_secure_custom_login_url)))),m=({settings:e,updateSetting:r})=>{const t=e.nhrrob_secure_2fa_enforced_roles||[],l=e.available_roles||[];return(0,a.createElement)(n.Card,{className:"nhrrob-secure-card"},(0,a.createElement)(n.CardBody,null,(0,a.createElement)("h2",{className:"nhrrob-secure-card-title"},(0,s.__)("Two-Factor Authentication","nhrrob-secure")),(0,a.createElement)(n.ToggleControl,{label:(0,s.__)("Enable Global 2FA","nhrrob-secure"),help:(0,a.createElement)(a.Fragment,null,(0,s.__)("Enables Google Authenticator support for all users. Users can set it up in their ","nhrrob-secure"),(0,a.createElement)("a",{href:nhrrobSecureSettings.profile_url,target:"_blank",rel:"noreferrer"},(0,s.__)("profile page","nhrrob-secure")),"."),checked:e.nhrrob_secure_enable_2fa,onChange:e=>r("nhrrob_secure_enable_2fa",e)}),e.nhrrob_secure_enable_2fa&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"nhrrob-secure-2fa-method pt-4 border-t border-gray-100"},(0,a.createElement)("h3",{className:"text-sm font-semibold mb-3"},(0,s.__)("2FA Method","nhrrob-secure")),(0,a.createElement)(n.RadioControl,{selected:e.nhrrob_secure_2fa_type||"app",options:[{label:(0,s.__)("Authenticator App (Recommended)","nhrrob-secure"),value:"app"},{label:(0,s.__)("Email OTP","nhrrob-secure"),value:"email"}],onChange:e=>r("nhrrob_secure_2fa_type",e)})),(0,a.createElement)("div",{className:"nhrrob-secure-enforced-roles pt-4 border-t border-gray-100"},(0,a.createElement)("h3",{className:"text-sm font-semibold mb-3"},(0,s.__)("Enforced 2FA by Role","nhrrob-secure")),(0,a.createElement)("p",{className:"text-xs text-gray-500 mb-4"},(0,s.__)("Users with the selected roles will be forced to set up 2FA before they can access the admin dashboard.","nhrrob-secure")),(0,a.createElement)("div",{className:"grid grid-cols-2 gap-2"},l.map(e=>(0,a.createElement)(n.CheckboxControl,{key:e.value,label:e.label,checked:t.includes(e.value),onChange:a=>((e,a)=>{const l=a?[...t,e]:t.filter(r=>r!==e);r("nhrrob_secure_2fa_enforced_roles",l)})(e.value,a)})))))))},b=({settings:e,updateSetting:r})=>(0,a.createElement)(n.Card,{className:"nhrrob-secure-card"},(0,a.createElement)(n.CardBody,null,(0,a.createElement)("h2",{className:"nhrrob-secure-card-title"},(0,s.__)("File Protection","nhrrob-secure")),(0,a.createElement)(n.ToggleControl,{label:(0,s.__)("Protect Debug Log","nhrrob-secure"),help:(0,s.__)("Block direct access to wp-content/debug.log","nhrrob-secure"),checked:e.nhrrob_secure_protect_debug_log,onChange:e=>r("nhrrob_secure_protect_debug_log",e)}))),d=window.wp.htmlEntities,h=()=>{const[e,r]=(0,l.useState)(null),[t,c]=(0,l.useState)(!0),[i,u]=(0,l.useState)(!1),[m,b]=(0,l.useState)(null);(0,l.useEffect)(()=>{h()},[]);const h=async()=>{try{const e=await o()({path:"/nhrrob-secure/v1/vulnerability/status"});r(e),c(!1)}catch(e){b((0,s.__)("Failed to fetch vulnerability status","nhrrob-secure")),c(!1)}};if(t)return(0,a.createElement)(n.Card,{className:"nhrrob-secure-card"},(0,a.createElement)(n.CardBody,null,(0,a.createElement)(n.Spinner,null)));const _=e&&(e.core.length>0||e.plugins.length>0||e.themes.length>0);return(0,a.createElement)(n.Card,{className:"nhrrob-secure-card nhrrob-secure-vulnerability-card"},(0,a.createElement)(n.CardBody,null,(0,a.createElement)("div",{className:"nhrrob-secure-card-header-flex"},(0,a.createElement)("h2",{className:"nhrrob-secure-card-title"},(0,s.__)("Vulnerability Checker","nhrrob-secure")),(0,a.createElement)(n.Button,{variant:"primary",onClick:async()=>{u(!0),b(null);try{const e=await o()({path:"/nhrrob-secure/v1/vulnerability/scan",method:"POST"});r(e)}catch(e){b((0,s.__)("Failed to run vulnerability scan","nhrrob-secure"))}finally{u(!1)}},isBusy:i,disabled:i,icon:"update",iconPosition:"right"},i?(0,s.__)("Scanning...","nhrrob-secure"):(0,s.__)("Scan Now","nhrrob-secure"))),(0,a.createElement)("p",{className:"nhrrob-secure-last-scan"},(0,a.createElement)("strong",null,(0,s.__)("Last Scan:","nhrrob-secure"))," ",(g=e.last_scan)?new Date(1e3*g).toLocaleString():(0,s.__)("Never","nhrrob-secure")),m&&(0,a.createElement)(n.Notice,{status:"error",isDismissible:!1},m),_?(0,a.createElement)("div",{className:"nhrrob-secure-vulnerability-list"},(0,a.createElement)(n.Notice,{status:"warning",isDismissible:!1},(0,s.__)("Vulnerabilities detected! Please review and update the items below.","nhrrob-secure")),e.core.length>0&&(0,a.createElement)("div",{className:"vulnerability-section"},(0,a.createElement)("h3",null,(0,s.__)("WordPress Core","nhrrob-secure")),(0,a.createElement)("ul",null,e.core.map((e,r)=>(0,a.createElement)("li",{key:r},(0,d.decodeEntities)(e.name))))),e.plugins.length>0&&(0,a.createElement)("div",{className:"vulnerability-section"},(0,a.createElement)("h3",null,(0,s.__)("Plugins","nhrrob-secure")),e.plugins.map((e,r)=>(0,a.createElement)("div",{key:r,className:"vulnerability-item"},(0,a.createElement)("strong",null,(0,a.createElement)("a",{href:"plugins.php",style:{textDecoration:"none",color:"inherit"}},(0,d.decodeEntities)(e.name)),(0,a.createElement)("span",{style:{fontWeight:"normal",color:"#666"}}," (",e.version,")")),(0,a.createElement)("ul",null,e.vulnerabilities.map((e,r)=>(0,a.createElement)("li",{key:r},(0,d.decodeEntities)(e.name))))))),e.themes.length>0&&(0,a.createElement)("div",{className:"vulnerability-section"},(0,a.createElement)("h3",null,(0,s.__)("Themes","nhrrob-secure")),e.themes.map((e,r)=>(0,a.createElement)("div",{key:r,className:"vulnerability-item"},(0,a.createElement)("strong",null,(0,d.decodeEntities)(e.name)," (",e.version,")"),(0,a.createElement)("ul",null,e.vulnerabilities.map((e,r)=>(0,a.createElement)("li",{key:r},(0,d.decodeEntities)(e.name)))))))):(0,a.createElement)("div",{className:"nhrrob-secure-status-success"},(0,a.createElement)("span",{className:"dashicons dashicons-yes-alt"}),(0,s.__)("No known vulnerabilities detected.","nhrrob-secure"))));var g},_=()=>{const[e,r]=(0,l.useState)(!1),[t,c]=(0,l.useState)(null),[i,u]=(0,l.useState)(null),[m,b]=(0,l.useState)("core"),d=async()=>{r(!0),u(null),c(null);try{const e="core"===m?"/nhrrob-secure/v1/scanner/core":"/nhrrob-secure/v1/scanner/malware",r=await o()({path:e,method:"POST"});c(r)}catch(e){u(e.message||(0,s.__)("An error occurred during scan.","nhrrob-secure"))}finally{r(!1)}};return(0,a.createElement)("div",{className:"nhrrob-secure-card nhrrob-secure-vulnerability-card padded-header"},(0,a.createElement)("div",{className:"nhrrob-secure-card-header-flex"},(0,a.createElement)("div",{className:"nhrrob-secure-header-content"},(0,a.createElement)("h2",{className:"nhrrob-secure-card-title"},(0,s.__)("File Scanner","nhrrob-secure")),(0,a.createElement)("p",{className:"nhrrob-secure-card-subtitle"},(0,s.__)("Scan your site for file modifications and potential malware.","nhrrob-secure"))),(0,a.createElement)("div",{className:"nhrrob-scan-controls"},(0,a.createElement)("div",{className:"nhrrob-scan-type-toggle"},(0,a.createElement)("button",{className:"nhrrob-scan-toggle-btn "+("core"===m?"active":""),onClick:()=>b("core"),disabled:e},(0,s.__)("Core Integrity","nhrrob-secure")),(0,a.createElement)("button",{className:"nhrrob-scan-toggle-btn "+("malware"===m?"active":""),onClick:()=>b("malware"),disabled:e},(0,s.__)("Malware Scan","nhrrob-secure"))),(0,a.createElement)(n.Button,{variant:"primary",onClick:()=>d(),isBusy:e,disabled:e,icon:"update",iconPosition:"right"},e?(0,s.__)("Scanning...","nhrrob-secure"):(0,s.__)("Start Scan","nhrrob-secure")))),(0,a.createElement)("div",{className:"nhrrob-card-body"},i&&(0,a.createElement)("div",{className:"notice notice-error inline-notice"},(0,a.createElement)("p",null,i)),t&&(0,a.createElement)("div",{className:"nhrrob-secure-vulnerability-list"},("core"===m&&(t.modified?.length>0||t.missing?.length>0)||"malware"===m&&t.suspicious?.length>0)&&(0,a.createElement)("div",{className:"notice notice-warning inline-notice nhrrob-warning-notice"},(0,a.createElement)("p",null,(0,s.__)("Issues detected! Please review and update the items below.","nhrrob-secure"))),"core"===m&&(0,a.createElement)(a.Fragment,null,t.modified&&t.modified.length>0&&(0,a.createElement)("div",{className:"nhrrob-result-group"},(0,a.createElement)("h3",{className:"nhrrob-result-group-title"},(0,s.__)("Modified Core Files","nhrrob-secure")),(0,a.createElement)("div",{className:"nhrrob-result-list"},t.modified.map((e,r)=>(0,a.createElement)("div",{key:r,className:"nhrrob-result-row"},(0,a.createElement)("div",{className:"nhrrob-file-info"},(0,a.createElement)("strong",null,e)),(0,a.createElement)(n.Button,{variant:"secondary",isSmall:!0,onClick:()=>(async e=>{if(confirm((0,s.__)("Are you sure you want to repair this file? It will be overwritten with the original version.","nhrrob-secure")))try{await o()({path:"/nhrrob-secure/v1/scanner/repair",method:"POST",data:{file:e}}),alert((0,s.__)("File repaired successfully.","nhrrob-secure")),d()}catch(e){alert(e.message||(0,s.__)("Repair failed.","nhrrob-secure"))}})(e)},(0,s.__)("Repair","nhrrob-secure")))))),t.missing&&t.missing.length>0&&(0,a.createElement)("div",{className:"nhrrob-result-group"},(0,a.createElement)("h3",{className:"nhrrob-result-group-title"},(0,s.__)("Missing Core Files","nhrrob-secure")),(0,a.createElement)("div",{className:"nhrrob-result-list"},t.missing.map((e,r)=>(0,a.createElement)("div",{key:r,className:"nhrrob-result-row"},(0,a.createElement)("div",{className:"nhrrob-file-info"},(0,a.createElement)("strong",null,e)))))),!t.modified?.length&&!t.missing?.length&&(0,a.createElement)("div",{className:"nhrrob-secure-status-success"},(0,a.createElement)("span",{className:"dashicons dashicons-yes-alt"}),(0,s.__)("No modified core files found.","nhrrob-secure"))),"malware"===m&&(0,a.createElement)(a.Fragment,null,t.suspicious&&t.suspicious.length>0?(0,a.createElement)("div",{className:"nhrrob-result-group"},(0,a.createElement)("h3",{className:"nhrrob-result-group-title"},(0,s.__)("Suspicious Files","nhrrob-secure")),(0,a.createElement)("div",{className:"nhrrob-result-list"},t.suspicious.map((e,r)=>(0,a.createElement)("div",{key:r,className:"nhrrob-result-row"},(0,a.createElement)("div",{className:"nhrrob-file-info"},(0,a.createElement)("strong",null,e.file),(0,a.createElement)("span",{className:"nhrrob-file-meta"},e.reason)),(0,a.createElement)(n.Button,{variant:"link",isDestructive:!0,onClick:()=>(async e=>{if(confirm((0,s.__)("Are you sure you want to PERMANENTLY delete this file?","nhrrob-secure")))try{await o()({path:"/nhrrob-secure/v1/scanner/delete",method:"POST",data:{file:e}}),alert((0,s.__)("File deleted successfully.","nhrrob-secure")),d()}catch(e){alert(e.message||(0,s.__)("Delete failed.","nhrrob-secure"))}})(e.file)},(0,s.__)("Delete","nhrrob-secure")))))):(0,a.createElement)("div",{className:"nhrrob-secure-status-success"},(0,a.createElement)("span",{className:"dashicons dashicons-yes-alt"}),(0,s.__)("No suspicious files found.","nhrrob-secure")),(0,a.createElement)("p",{className:"description nhrrob-scan-count"},(0,a.createElement)("small",null,(0,s.__)("Scanned files:","nhrrob-secure")," ",t.scanned_count))))))},g=({settings:e,updateSetting:r})=>(0,a.createElement)(n.Card,{className:"nhrrob-secure-card nhrrob-secure-hardening-card"},(0,a.createElement)(n.CardBody,null,(0,a.createElement)("h2",{className:"nhrrob-secure-card-title"},(0,s.__)("Hardening & Firewall","nhrrob-secure")),(0,a.createElement)("div",{className:"nhrrob-secure-setting-group"},(0,a.createElement)("h3",{className:"nhrrob-secure-setting-subtitle"},(0,s.__)("General Hardening","nhrrob-secure")),(0,a.createElement)(n.ToggleControl,{label:(0,s.__)("Disable XML-RPC","nhrrob-secure"),help:(0,s.__)("Prevents external systems (like mobile apps and Jetpack) from accessing your site via XML-RPC. Recommended if not used.","nhrrob-secure"),checked:e.nhrrob_secure_disable_xmlrpc,onChange:e=>r("nhrrob_secure_disable_xmlrpc",e)}),(0,a.createElement)(n.ToggleControl,{label:(0,s.__)("Disable File Editor","nhrrob-secure"),help:(0,s.__)("Disables the built-in theme and plugin file editor to prevent code execution if an admin account is compromised.","nhrrob-secure"),checked:e.nhrrob_secure_disable_file_editor,onChange:e=>r("nhrrob_secure_disable_file_editor",e)}),(0,a.createElement)(n.ToggleControl,{label:(0,s.__)("Hide WP Version","nhrrob-secure"),help:(0,s.__)("Removes WordPress version from page source and RSS feeds to make reconnaissance harder for attackers.","nhrrob-secure"),checked:e.nhrrob_secure_hide_wp_version,onChange:e=>r("nhrrob_secure_hide_wp_version",e)}),(0,a.createElement)(n.ToggleControl,{label:(0,s.__)("Disable REST API User Enumeration","nhrrob-secure"),help:(0,s.__)("Blocks access to /wp-json/wp/v2/users to prevent attackers from listing your users.","nhrrob-secure"),checked:e.nhrrob_secure_disable_rest_users,onChange:e=>r("nhrrob_secure_disable_rest_users",e)})),(0,a.createElement)("div",{className:"nhrrob-secure-setting-group border-t border-gray-100 pt-4 mt-4"},(0,a.createElement)("h3",{className:"nhrrob-secure-setting-subtitle"},(0,s.__)("Firewall Rules","nhrrob-secure")),(0,a.createElement)(n.ToggleControl,{label:(0,s.__)("Advanced Firewall (IPS) Protection","nhrrob-secure"),help:(0,s.__)("Proactively block common attacks like SQL Injection, XSS, and LFI by scanning request data.","nhrrob-secure"),checked:e?.nhrrob_secure_enable_advanced_firewall||!1,onChange:e=>r("nhrrob_secure_enable_advanced_firewall",e)}),(0,a.createElement)(n.TextareaControl,{label:(0,s.__)("Block User Agents","nhrrob-secure"),help:(0,s.__)('Enter one User-Agent per line to block. Case-insensitive partial match. Example: "HTTrack", "curl".',"nhrrob-secure"),value:e.nhrrob_secure_firewall_blocked_uas,onChange:e=>r("nhrrob_secure_firewall_blocked_uas",e),rows:5,placeholder:"SemrushBot\nAhrefsBot\nMJ12bot"})))),v=({settings:e,updateSetting:r})=>{const[t,c]=(0,l.useState)([]),[i,u]=(0,l.useState)(!1),[m,b]=(0,l.useState)(null);(0,l.useEffect)(()=>{d()},[]);const d=async()=>{u(!0),b(null);try{const e=await o()({path:"/nhrrob-secure/v1/sessions"});c(e)}catch(e){b(e.message||(0,s.__)("Failed to load sessions.","nhrrob-secure"))}finally{u(!1)}};return(0,a.createElement)(n.Card,{className:"nhrrob-secure-card nhrrob-secure-sessions-card"},(0,a.createElement)(n.CardBody,null,(0,a.createElement)("div",{className:"nhrrob-secure-card-header-flex"},(0,a.createElement)("h2",{className:"nhrrob-secure-card-title"},(0,s.__)("User Session Management","nhrrob-secure")),(0,a.createElement)(n.Button,{variant:"primary",onClick:d,isBusy:i,disabled:i,icon:"update"},(0,s.__)("Refresh","nhrrob-secure"))),(0,a.createElement)("div",{className:"nhrrob-secure-setting-group"},(0,a.createElement)(n.TextControl,{label:(0,s.__)("Idle Timeout (Minutes)","nhrrob-secure"),help:(0,s.__)("Automatically log out inactive users after X minutes. Set to 0 to disable.","nhrrob-secure"),type:"number",value:e?.nhrrob_secure_idle_timeout||0,onChange:e=>r("nhrrob_secure_idle_timeout",parseInt(e)||0),min:"0"})),m&&(0,a.createElement)(n.Notice,{status:"error",isDismissible:!1},m),(0,a.createElement)("div",{className:"nhrrob-secure-sessions-list mt-4"},(0,a.createElement)("h3",{className:"text-sm font-semibold mb-3"},(0,s.__)("Active Sessions","nhrrob-secure")),0!==t.length||i?(0,a.createElement)("div",{className:"sessions-grid"},t.map((e,r)=>(0,a.createElement)("div",{key:r,className:"session-item p-3 border rounded mb-2 "+(e.is_current?"bg-blue-50 border-blue-200":"bg-gray-50 border-gray-200")},(0,a.createElement)("div",{className:"flex justify-between items-start"},(0,a.createElement)("div",{className:"session-info"},(0,a.createElement)("div",{className:"font-medium text-gray-700"},e.ip,e.is_current&&(0,a.createElement)("span",{className:"ml-2 px-2 py-0.5 text-xs bg-blue-100 text-blue-800 rounded-full"},(0,s.__)("Current Session","nhrrob-secure"))),(0,a.createElement)("div",{className:"text-xs text-gray-500 mt-1"},(0,a.createElement)("div",null,(0,s.__)("Login:","nhrrob-secure")," ",new Date(1e3*e.login).toLocaleString()),(0,a.createElement)("div",null,(0,s.__)("Expires:","nhrrob-secure")," ",new Date(1e3*e.expiration).toLocaleString()),(0,a.createElement)("div",{className:"mt-1 font-mono text-gray-400 truncate w-64",title:e.ua},e.ua))),!e.is_current&&(0,a.createElement)(n.Button,{variant:"link",isDestructive:!0,onClick:()=>(async e=>{if(confirm((0,s.__)("Are you sure you want to log out this session?","nhrrob-secure")))try{await o()({path:"/nhrrob-secure/v1/sessions/destroy",method:"POST",data:{verifier:e}}),d()}catch(e){alert(e.message||(0,s.__)("Failed to destroy session.","nhrrob-secure"))}})(e.verifier)},(0,s.__)("Logout","nhrrob-secure")))))):(0,a.createElement)("p",null,(0,s.__)("No active sessions found.","nhrrob-secure"))),t.length>1&&(0,a.createElement)("div",{className:"mt-4 pt-3 border-t"},(0,a.createElement)(n.Button,{variant:"secondary",isDestructive:!0,onClick:async()=>{if(confirm((0,s.__)("Are you sure you want to log out all other devices?","nhrrob-secure")))try{await o()({path:"/nhrrob-secure/v1/sessions/destroy-others",method:"POST"}),d(),alert((0,s.__)("All other sessions logged out.","nhrrob-secure"))}catch(e){alert(e.message||(0,s.__)("Failed to destroy sessions.","nhrrob-secure"))}},className:"justify-center h-auto py-2 text-xs"},(0,s.__)("Log Out All Other Devices","nhrrob-secure")))))},p=({settings:e,updateSetting:r})=>{const[t,c]=(0,l.useState)([]),[i,u]=(0,l.useState)(!0),[m,b]=(0,l.useState)(0),[d,h]=(0,l.useState)(1);(0,l.useEffect)(()=>{_()},[d]);const _=async()=>{u(!0);try{const e=20*(d-1),r=await o()({path:`/nhrrob-secure/v1/logs?limit=20&offset=${e}`});c(r.items),b(r.total)}catch(e){console.error(e)}finally{u(!1)}},g=Math.ceil(m/20);return(0,a.createElement)(n.Card,{className:"nhrrob-secure-card nhrrob-secure-audit-log-card"},(0,a.createElement)(n.CardBody,null,(0,a.createElement)("div",{className:"nhrrob-secure-card-header-flex"},(0,a.createElement)("h2",{className:"nhrrob-secure-card-title"},(0,s.__)("Activity Audit Log","nhrrob-secure")),(0,a.createElement)("div",{className:"nhrrob-secure-card-header-actions"},e&&(0,a.createElement)(n.SelectControl,{className:"nhrrob-secure-retention-select",value:e.nhrrob_secure_log_retention_days,options:[{label:(0,s.__)("Keep logs: 7 days","nhrrob-secure"),value:7},{label:(0,s.__)("Keep logs: 30 days","nhrrob-secure"),value:30},{label:(0,s.__)("Keep logs: 90 days","nhrrob-secure"),value:90},{label:(0,s.__)("Keep logs: 1 year","nhrrob-secure"),value:365}],onChange:e=>r("nhrrob_secure_log_retention_days",parseInt(e))}),(0,a.createElement)(n.Button,{variant:"primary",onClick:_,disabled:i,isBusy:i,icon:"update",iconPosition:"right"},(0,s.__)("Refresh","nhrrob-secure")))),i&&(0,a.createElement)("div",{className:"nhrrob-secure-loading-overlay"},(0,a.createElement)(n.Spinner,null)),(0,a.createElement)("div",{className:"nhrrob-secure-audit-table-wrapper"},(0,a.createElement)("table",{className:"nhrrob-secure-audit-table"},(0,a.createElement)("thead",null,(0,a.createElement)("tr",null,(0,a.createElement)("th",null,(0,s.__)("Date","nhrrob-secure")),(0,a.createElement)("th",null,(0,s.__)("User","nhrrob-secure")),(0,a.createElement)("th",null,(0,s.__)("Context","nhrrob-secure")),(0,a.createElement)("th",null,(0,s.__)("Action","nhrrob-secure")),(0,a.createElement)("th",null,(0,s.__)("Item","nhrrob-secure")),(0,a.createElement)("th",null,(0,s.__)("IP Address","nhrrob-secure")))),(0,a.createElement)("tbody",null,t.length>0?t.map(e=>(0,a.createElement)("tr",{key:e.id,className:`severity-${e.severity}`},(0,a.createElement)("td",null,new Date(e.date).toLocaleString()),(0,a.createElement)("td",null,e.user),(0,a.createElement)("td",null,(0,a.createElement)("span",{className:"nhrrob-secure-badge"},e.context)),(0,a.createElement)("td",null,e.action),(0,a.createElement)("td",null,e.label),(0,a.createElement)("td",null,e.ip))):(0,a.createElement)("tr",null,(0,a.createElement)("td",{colSpan:"6",className:"no-logs"},!i&&(0,s.__)("No activity logs found.","nhrrob-secure")))))),g>1&&(0,a.createElement)("div",{className:"nhrrob-secure-pagination"},(0,a.createElement)(n.Button,{isSmall:!0,disabled:1===d||i,onClick:()=>h(d-1)},"« ",(0,s.__)("Prev","nhrrob-secure")),(0,a.createElement)("span",{className:"nhrrob-secure-page-info"},(0,s.__)("Page","nhrrob-secure")," ",d," ",(0,s.__)("of","nhrrob-secure")," ",g),(0,a.createElement)(n.Button,{isSmall:!0,disabled:d===g||i,onClick:()=>h(d+1)},(0,s.__)("Next","nhrrob-secure")," »"))))},E=({onApplyOneClick:e})=>{const[r,t]=(0,l.useState)(null),[c,i]=(0,l.useState)(!0),[u,m]=(0,l.useState)(!1);(0,l.useEffect)(()=>{b()},[]);const b=async()=>{try{const e=await o()({path:"/nhrrob-secure/v1/health-stats"});t(e),i(!1)}catch(e){console.error("Failed to fetch health stats",e),i(!1)}};if(c)return(0,a.createElement)("div",{className:"nhrrob-secure-card p-6 flex items-center justify-center"},(0,a.createElement)(n.Spinner,null));if(!r)return null;const{score:d,total:h,checks:_,grade:g}=r,v=Math.round(d/h*100);return(0,a.createElement)("div",{className:"nhrrob-secure-card h-full flex flex-col"},(0,a.createElement)("div",{className:"p-5 border-b border-gray-100 dark:border-gray-800 flex items-center justify-between"},(0,a.createElement)("div",null,(0,a.createElement)("h2",{className:"nhrrob-secure-card-title border-0 pb-0"},(0,s.__)("Security Health Check","nhrrob-secure")),(0,a.createElement)("p",{className:"text-xs text-gray-500 mt-1"},(0,s.__)("Overall protection status of your WordPress site","nhrrob-secure"))),(0,a.createElement)("div",{className:"text-2xl font-bold px-3 py-1 rounded-lg "+(E=g,E.startsWith("A")?"bg-green-100 text-green-700":"B"===E?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700")},g)),(0,a.createElement)("div",{className:"p-6 flex flex-col md:flex-row items-center gap-8"},(0,a.createElement)("div",{className:"relative w-32 h-32 flex items-center justify-center"},(0,a.createElement)("svg",{className:"w-full h-full transform -rotate-90"},(0,a.createElement)("circle",{cx:"64",cy:"64",r:"58",stroke:"currentColor",strokeWidth:"10",fill:"transparent",className:"text-gray-100 dark:text-gray-800"}),(0,a.createElement)("circle",{cx:"64",cy:"64",r:"58",stroke:"currentColor",strokeWidth:"10",fill:"transparent",strokeDasharray:364,strokeDashoffset:364-364*v/100,strokeLinecap:"round",className:"transition-all duration-1000 ease-out "+(p=v,p>=80?"text-green-500":p>=60?"text-yellow-500":"text-red-500")})),(0,a.createElement)("div",{className:"absolute flex flex-col items-center"},(0,a.createElement)("span",{className:"text-3xl font-bold"},v,"%"),(0,a.createElement)("span",{className:"text-[10px] uppercase tracking-wider text-gray-400 font-semibold"},(0,s.__)("Secure","nhrrob-secure")))),(0,a.createElement)("div",{className:"flex-1 w-full"},(0,a.createElement)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-4"},_.map(e=>(0,a.createElement)("div",{key:e.id,className:"flex items-start gap-2 group"},(0,a.createElement)("div",{className:"mt-0.5 rounded-full p-0.5 "+(e.passed?"text-green-500":"text-red-400 opacity-60")},(0,a.createElement)(n.Icon,{icon:e.passed?"yes":"no-alt",size:16})),(0,a.createElement)("div",null,(0,a.createElement)("span",{className:"text-xs font-medium "+(e.passed?"text-gray-700 dark:text-gray-300":"text-gray-400")},e.label))))),(0,a.createElement)(n.Button,{variant:"secondary",className:"justify-center text-xs py-2 h-auto hover:bg-blue-600 hover:text-white transition-colors",onClick:async()=>{m(!0);try{const r=await o()({path:"/nhrrob-secure/v1/one-click-secure",method:"POST"});r.success&&(t(r.stats),e(r.settings))}catch(e){console.error("One-click secure failed",e)}finally{m(!1)}},isBusy:u,disabled:u},u?(0,s.__)("Applying...","nhrrob-secure"):(0,s.__)("One-Click Secure Recommendations","nhrrob-secure")))));var p,E},y=({settings:e,updateSetting:r})=>{const t=[{label:(0,s.__)("Select Countries to Block...","nhrrob-secure"),value:""},{label:"Afghanistan",value:"AF"},{label:"Albania",value:"AL"},{label:"Algeria",value:"DZ"},{label:"Argentina",value:"AR"},{label:"Australia",value:"AU"},{label:"Austria",value:"AT"},{label:"Bangladesh",value:"BD"},{label:"Belarus",value:"BY"},{label:"Belgium",value:"BE"},{label:"Brazil",value:"BR"},{label:"Bulgaria",value:"BG"},{label:"Canada",value:"CA"},{label:"Chile",value:"CL"},{label:"China",value:"CN"},{label:"Colombia",value:"CO"},{label:"Croatia",value:"HR"},{label:"Cuba",value:"CU"},{label:"Czech Republic",value:"CZ"},{label:"Denmark",value:"DK"},{label:"Egypt",value:"EG"},{label:"Estonia",value:"EE"},{label:"Ethiopia",value:"ET"},{label:"Finland",value:"FI"},{label:"France",value:"FR"},{label:"Germany",value:"DE"},{label:"Ghana",value:"GH"},{label:"Greece",value:"GR"},{label:"Hong Kong",value:"HK"},{label:"Hungary",value:"HU"},{label:"Iceland",value:"IS"},{label:"India",value:"IN"},{label:"Indonesia",value:"ID"},{label:"Iran",value:"IR"},{label:"Iraq",value:"IQ"},{label:"Ireland",value:"IE"},{label:"Israel",value:"IL"},{label:"Italy",value:"IT"},{label:"Japan",value:"JP"},{label:"Kazakhstan",value:"KZ"},{label:"Kenya",value:"KE"},{label:"Kuwait",value:"KW"},{label:"Latvia",value:"LV"},{label:"Lebanon",value:"LB"},{label:"Libya",value:"LY"},{label:"Lithuania",value:"LT"},{label:"Luxembourg",value:"LU"},{label:"Malaysia",value:"MY"},{label:"Mexico",value:"MX"},{label:"Morocco",value:"MA"},{label:"Myanmar",value:"MM"},{label:"Nepal",value:"NP"},{label:"Netherlands",value:"NL"},{label:"New Zealand",value:"NZ"},{label:"Nigeria",value:"NG"},{label:"North Korea",value:"KP"},{label:"Norway",value:"NO"},{label:"Pakistan",value:"PK"},{label:"Palestine",value:"PS"},{label:"Philippines",value:"PH"},{label:"Poland",value:"PL"},{label:"Portugal",value:"PT"},{label:"Qatar",value:"QA"},{label:"Romania",value:"RO"},{label:"Russia",value:"RU"},{label:"Saudi Arabia",value:"SA"},{label:"Serbia",value:"RS"},{label:"Singapore",value:"SG"},{label:"Slovakia",value:"SK"},{label:"Slovenia",value:"SI"},{label:"Somalia",value:"SO"},{label:"South Africa",value:"ZA"},{label:"South Korea",value:"KR"},{label:"Spain",value:"ES"},{label:"Sri Lanka",value:"LK"},{label:"Sudan",value:"SD"},{label:"Sweden",value:"SE"},{label:"Switzerland",value:"CH"},{label:"Syria",value:"SY"},{label:"Taiwan",value:"TW"},{label:"Thailand",value:"TH"},{label:"Turkey",value:"TR"},{label:"Ukraine",value:"UA"},{label:"United Arab Emirates",value:"AE"},{label:"United Kingdom",value:"GB"},{label:"United States",value:"US"},{label:"Venezuela",value:"VE"},{label:"Vietnam",value:"VN"},{label:"Yemen",value:"YE"},{label:"Zimbabwe",value:"ZW"}],l=e.nhrrob_secure_blocked_countries||[],c=e=>{if(!e)return;let t;t=l.includes(e)?l.filter(r=>r!==e):[...l,e],r("nhrrob_secure_blocked_countries",t)};return(0,a.createElement)(n.Card,{className:"nhrrob-secure-card nhrrob-secure-ip-card"},(0,a.createElement)(n.CardBody,null,(0,a.createElement)("h2",{className:"nhrrob-secure-card-title"},(0,s.__)("IP & Country Management","nhrrob-secure")),(0,a.createElement)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-6"},(0,s.__)("Control access to your site by whitelisting safe IPs or blocking malicious ones and entire countries.","nhrrob-secure")),(0,a.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},(0,a.createElement)("div",{className:"nhrrob-secure-setting-group"},(0,a.createElement)("label",{className:"block text-sm font-semibold text-green-600 dark:text-green-400 mb-2"},(0,s.__)("IP Whitelist (Safe)","nhrrob-secure")),(0,a.createElement)(n.TextareaControl,{help:(0,s.__)("One IP or CIDR per line (e.g., 192.168.1.1 or 10.0.0.0/24). Whitelisted IPs bypass all security filters.","nhrrob-secure"),value:e.nhrrob_secure_ip_whitelist,onChange:e=>r("nhrrob_secure_ip_whitelist",e),rows:6,placeholder:"1.2.3.4"})),(0,a.createElement)("div",{className:"nhrrob-secure-setting-group"},(0,a.createElement)("label",{className:"block text-sm font-semibold text-red-600 dark:text-red-400 mb-2"},(0,s.__)("IP Blacklist (Blocked)","nhrrob-secure")),(0,a.createElement)(n.TextareaControl,{help:(0,s.__)("One IP or CIDR per line. Blacklisted IPs are blocked immediately from the entire site.","nhrrob-secure"),value:e.nhrrob_secure_ip_blacklist,onChange:e=>r("nhrrob_secure_ip_blacklist",e),rows:6,placeholder:"5.6.7.8"}))),(0,a.createElement)("div",{className:"mt-8 border-t border-gray-100 dark:border-gray-700"},(0,a.createElement)("h3",{className:"text-sm font-semibold mb-4 text-gray-900 dark:text-gray-100"},(0,s.__)("Country Blocking","nhrrob-secure")),(0,a.createElement)("div",{className:"flex flex-wrap gap-4 items-end"},(0,a.createElement)("div",{className:"flex-1 max-w-xs nhrrob-secure-country-select"},(0,a.createElement)(n.SelectControl,{label:(0,s.__)("Add Country to Block","nhrrob-secure"),options:t,onChange:c,className:"dark-mode-select"}))),l.length>0&&(0,a.createElement)("div",{className:"mt-4 flex flex-wrap gap-2"},l.map(e=>(0,a.createElement)("div",{key:e,className:"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 px-3 py-1.5 rounded-full text-xs font-medium flex items-center gap-1 border border-red-200 dark:border-red-800/50"},t.find(r=>r.value===e)?.label||e,(0,a.createElement)("button",{onClick:()=>c(e),className:"focus:outline-none transition-colors text-sm leading-none -mr-0.5 bg-red-50 dark:bg-red-900/20 border-none cursor-pointer",title:(0,s.__)("Remove","nhrrob-secure"),"aria-label":(0,s.__)("Remove","nhrrob-secure")},"×")))),(0,a.createElement)("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-4 italic"},(0,s.__)("Note: Country blocking uses a free GeoIP lookup service with caching for performance.","nhrrob-secure")))))},f=document.getElementById("nhrrob-secure-settings-root");f&&(0,l.render)((0,a.createElement)(()=>{const[e,r]=(0,l.useState)(null),[t,c]=(0,l.useState)(!0),[d,f]=(0,l.useState)(!1),[N,k]=(0,l.useState)(null);(0,l.useEffect)(()=>{x()},[]);const x=async()=>{try{const e=await o()({path:"/nhrrob-secure/v1/settings"});r(e),c(!1)}catch(e){k({type:"error",message:(0,s.__)("Failed to load settings","nhrrob-secure")}),c(!1)}},w=(t,a)=>{r({...e,[t]:a})};return(0,l.useEffect)(()=>{e?.nhrrob_secure_dark_mode?document.body.classList.add("nhrrob-secure-dark-mode-active"):document.body.classList.remove("nhrrob-secure-dark-mode-active")},[e?.nhrrob_secure_dark_mode]),t?(0,a.createElement)("div",{className:"nhrrob-secure-loading"},(0,a.createElement)(n.Spinner,null)):(0,a.createElement)("div",{className:"nhrrob-secure-settings "+(e.nhrrob_secure_dark_mode?"dark-mode":"")},(0,a.createElement)("div",{className:"nhrrob-secure-header"},(0,a.createElement)("div",{className:"nhrrob-secure-header-main"},(0,a.createElement)("h1",null,(0,s.__)("NHR Secure Settings","nhrrob-secure")),(0,a.createElement)(n.Button,{className:"nhrrob-secure-dark-mode-toggle",icon:e.nhrrob_secure_dark_mode?(0,a.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20"},(0,a.createElement)("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 00-1.41-1.41l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 00-1.41-1.41l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})):(0,a.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20"},(0,a.createElement)("path",{d:"M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"})),onClick:async()=>{const r=!e.nhrrob_secure_dark_mode;w("nhrrob_secure_dark_mode",r);try{await o()({path:"/nhrrob-secure/v1/settings",method:"POST",data:{...e,nhrrob_secure_dark_mode:r}})}catch(e){console.error("Failed to save dark mode preference",e)}},label:(0,s.__)("Toggle Dark Mode","nhrrob-secure")})),(0,a.createElement)("p",{className:"nhrrob-secure-subtitle"},(0,s.__)("Configure security features for your WordPress site","nhrrob-secure"))),N&&(0,a.createElement)(n.Notice,{status:N.type,isDismissible:!0,onRemove:()=>k(null)},N.message),(0,a.createElement)("div",{className:"nhrrob-secure-cards"},(0,a.createElement)("div",{className:"md:col-span-2 lg:col-span-3"},(0,a.createElement)(E,{onApplyOneClick:e=>r(e)})),(0,a.createElement)("div",{className:"md:col-span-2 lg:col-span-3"},(0,a.createElement)(i,{settings:e,updateSetting:w})),(0,a.createElement)("div",{className:"md:col-span-2 lg:col-span-3"},(0,a.createElement)(u,{settings:e,updateSetting:w})),(0,a.createElement)("div",{className:"md:col-span-2 lg:col-span-3"},(0,a.createElement)(m,{settings:e,updateSetting:w})),(0,a.createElement)("div",{className:"md:col-span-2 lg:col-span-3"},(0,a.createElement)(g,{settings:e,updateSetting:w})),(0,a.createElement)("div",{className:"md:col-span-2 lg:col-span-3"},(0,a.createElement)(b,{settings:e,updateSetting:w})),(0,a.createElement)("div",{className:"md:col-span-2 lg:col-span-3"},(0,a.createElement)(h,null)),(0,a.createElement)("div",{className:"md:col-span-2 lg:col-span-3"},(0,a.createElement)(y,{settings:e,updateSetting:w})),(0,a.createElement)("div",{className:"md:col-span-2 lg:col-span-3"},(0,a.createElement)(_,null)),(0,a.createElement)("div",{className:"md:col-span-2 lg:col-span-3"},(0,a.createElement)(v,{settings:e,updateSetting:w})),(0,a.createElement)("div",{className:"md:col-span-2 lg:col-span-3"},(0,a.createElement)(p,{settings:e,updateSetting:w}))),(0,a.createElement)("div",{className:"nhrrob-secure-actions"},(0,a.createElement)(n.Button,{variant:"primary",onClick:async()=>{f(!0),k(null);try{await o()({path:"/nhrrob-secure/v1/settings",method:"POST",data:e}),k({type:"success",message:(0,s.__)("Settings saved successfully!","nhrrob-secure")})}catch(e){k({type:"error",message:(0,s.__)("Failed to save settings","nhrrob-secure")})}finally{f(!1)}},isBusy:d,disabled:d},d?(0,s.__)("Saving...","nhrrob-secure"):(0,s.__)("Save Settings","nhrrob-secure"))))},null),f)}},t={};function a(e){var l=t[e];if(void 0!==l)return l.exports;var n=t[e]={exports:{}};return r[e](n,n.exports,a),n.exports}a.m=r,e=[],a.O=(r,t,l,n)=>{if(!t){var s=1/0;for(u=0;u<e.length;u++){for(var[t,l,n]=e[u],c=!0,o=0;o<t.length;o++)(!1&n||s>=n)&&Object.keys(a.O).every(e=>a.O[e](t[o]))?t.splice(o--,1):(c=!1,n<s&&(s=n));if(c){e.splice(u--,1);var i=l();void 0!==i&&(r=i)}}return r}n=n||0;for(var u=e.length;u>0&&e[u-1][2]>n;u--)e[u]=e[u-1];e[u]=[t,l,n]},a.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return a.d(r,{a:r}),r},a.d=(e,r)=>{for(var t in r)a.o(r,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},a.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),(()=>{var e={884:0,15:0};a.O.j=r=>0===e[r];var r=(r,t)=>{var l,n,[s,c,o]=t,i=0;if(s.some(r=>0!==e[r])){for(l in c)a.o(c,l)&&(a.m[l]=c[l]);if(o)var u=o(a)}for(r&&r(t);i<s.length;i++)n=s[i],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(u)},t=globalThis.webpackChunknhrrob_secure=globalThis.webpackChunknhrrob_secure||[];t.forEach(r.bind(null,0)),t.push=r.bind(null,t.push.bind(t))})();var l=a.O(void 0,[15],()=>a(855));l=a.O(l)})();